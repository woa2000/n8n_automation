{"createdAt":"2025-10-21T13:01:17.626Z","updatedAt":"2025-10-22T14:09:47.000Z","id":"wbQzg5nWoUx1U5QB","name":"Disparar Campanha","active":true,"isArchived":false,"nodes":[{"parameters":{"httpMethod":"POST","path":"cf585cbf-a525-417c-b239-42628465ae18","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-3232,-688],"id":"acceeaaf-b417-4c5e-ab05-f59cab154e40","name":"Webhook","webhookId":"cf585cbf-a525-417c-b239-42628465ae18","disabled":true},{"parameters":{"operation":"get","propertyName":"statusDisparo","key":"statusDisparo","options":{}},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-3008,-688],"id":"57718e59-2e87-49f2-ab40-6adbd76b26de","name":"Redis","credentials":{"redis":{"id":"gG8VhT5nokZGqEH8","name":"Redis account"}},"disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"a174e22e-edc6-4705-8076-36c164d76f73","leftValue":"={{ $json.statusDisparo }}","rightValue":"Enviando","operator":{"type":"string","operation":"notEquals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-2800,-688],"id":"26138064-bac5-4012-9270-2a7f8c63b120","name":"If","disabled":true},{"parameters":{"operation":"set","key":"statusDisparo","value":"Enviando"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-2608,-704],"id":"38619bbf-6ee9-44ff-acb4-845d9a228921","name":"Redis1","credentials":{"redis":{"id":"QGqIVKbiyQHm3x0E","name":"Redis account 2"}},"disabled":true},{"parameters":{"url":"https://gerencial-homolog.ecconline.com.br/api/WhatsApp/RegistroParaDisparar","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1984,-768],"id":"03113824-42e3-4e08-91b2-e113892d1696","name":"HTTP Request","disabled":true},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"3c266a94-c8ed-43d3-82d0-68111490b2bb","leftValue":"={{ $json.encerrar }}","rightValue":"false","operator":{"type":"boolean","operation":"false","singleValue":true}},{"id":"e2ce4ef3-072e-4399-b78f-f59940ab067b","leftValue":"","rightValue":"","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1808,-768],"id":"8e38c8d9-6e91-4325-b9b1-59e903d810eb","name":"If1","disabled":true},{"parameters":{"method":"POST","url":"https://gerencial-homolog.ecconline.com.br/api/WhatsApp/DispararMensagem","sendQuery":true,"queryParameters":{"parameters":[{"name":"MensagemId","value":"={{ $json.mensagem.id }}"}]},"options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[-1504,-784],"id":"df1fb414-c11b-4bbc-8a89-b849316b6fa3","name":"HTTP Request1","disabled":true},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-2176,-832],"id":"14009b40-bece-4d7b-a25e-32a2b86852b3","name":"Loop Over Items","disabled":true},{"parameters":{},"type":"n8n-nodes-base.noOp","name":"Replace Me","typeVersion":1,"position":[-1376,-640],"id":"31c8105a-6cee-4540-afa8-880853d384b3","disabled":true},{"parameters":{"operation":"set","key":"statusDisparo","value":"Finalizado"},"type":"n8n-nodes-base.redis","typeVersion":1,"position":[-1664,-672],"id":"53b41b26-3ffd-4b17-8bf4-7b1d01527396","name":"Redis2","credentials":{"redis":{"id":"QGqIVKbiyQHm3x0E","name":"Redis account 2"}},"disabled":true},{"parameters":{"functionCode":"const total = 10000; // limite de iterações\nconst items = [];\nfor (let i = 0; i < total; i++) items.push({ json: { tick: i+1 } });\nreturn items;"},"id":"8ab28639-04c2-4017-8ce8-2a030c6bd3b6","name":"Seed Loop (Function)1","type":"n8n-nodes-base.function","typeVersion":1,"position":[-2384,-704],"disabled":true},{"parameters":{"operation":"get","propertyName":"statusDisparo","key":"statusDisparo","options":{}},"id":"28ada6b2-b565-434e-9103-224d9d76e53a","name":"Redis (get) inicial","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-3056,-80],"credentials":{"redis":{"id":"QGqIVKbiyQHm3x0E","name":"Redis account 2"}}},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.statusDisparo }}","value2":"Enviando"}]}},"id":"a3bc41e4-e7bc-4a6c-bf28-ba1409146f26","name":"IF status == Enviando?","type":"n8n-nodes-base.if","typeVersion":1,"position":[-2832,-80]},{"parameters":{"options":{"responseCode":200}},"id":"db822ea9-32b1-4c65-8fcd-c3ac08784119","name":"Responder (já em andamento)","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[-2608,32]},{"parameters":{"operation":"set","key":"statusDisparo","value":"Enviando"},"id":"a25f7de7-22ec-4061-a7be-4b8d25f362fb","name":"Redis (set) Enviando","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-2608,-192],"credentials":{"redis":{"id":"QGqIVKbiyQHm3x0E","name":"Redis account 2"}}},{"parameters":{"functionCode":"const total = 10000; // limite de iterações\nconst items = [];\nfor (let i = 0; i < total; i++) items.push({ json: { tick: i+1 } });\nreturn items;"},"id":"a1e29acd-fc9d-42a8-9a06-b425fcd9b110","name":"Seed Loop (Function)","type":"n8n-nodes-base.function","typeVersion":1,"position":[-2416,-192]},{"parameters":{"url":"https://gerencial.ecconline.com.br/api/WhatsApp/RegistroParaDisparar","options":{}},"id":"b0d508c7-ad5a-46c9-9e92-5d72609c36a5","name":"HTTP RegistroParaDisparar","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-2000,-288],"onError":"continueRegularOutput"},{"parameters":{"conditions":{"boolean":[{"value1":"={{ $json.encerrar }}","value2":"={{ true }}"}]}},"id":"c4aea2bc-d008-4059-a7d3-86ade72c4390","name":"IF tem item?","type":"n8n-nodes-base.if","typeVersion":1,"position":[-1584,-288]},{"parameters":{"method":"POST","url":"https://gerencial.ecconline.com.br/api/WhatsApp/DispararMensagem","sendQuery":true,"queryParameters":{"parameters":[{"name":"MensagemId","value":"={{ $json.mensagem.id }}"}]},"options":{}},"id":"1de78170-5600-43b7-b345-978c2060c968","name":"HTTP EnviarMensagem","type":"n8n-nodes-base.httpRequest","typeVersion":3,"position":[-1328,-16],"onError":"continueRegularOutput"},{"parameters":{"options":{"responseCode":200}},"id":"921338e2-6842-47c7-8197-c94f98ae0c90","name":"Responder (Finalizado)","type":"n8n-nodes-base.respondToWebhook","typeVersion":1,"position":[-848,-224]},{"parameters":{"httpMethod":"POST","path":"campanha/disparar","options":{}},"id":"d049c16f-964b-43f9-931c-1e0d8a9e0efc","name":"Webhook1","type":"n8n-nodes-base.webhook","typeVersion":1,"position":[-3264,-80],"webhookId":"287299c8-82b7-4fb3-ae77-0a3f82870bb4","executeOnce":false},{"parameters":{"batchSize":1,"options":{}},"id":"13ca5a02-8615-467c-9087-358df426c809","name":"Loop Over Items1","type":"n8n-nodes-base.splitInBatches","typeVersion":2,"position":[-2208,-192],"onError":"continueRegularOutput"},{"parameters":{"amount":0.3},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[-1120,-16],"id":"5fff17dd-4810-4e92-ae40-197870966d3d","name":"Wait","webhookId":"62e96045-b15b-4ada-ac72-cf4f9cd5760c"},{"parameters":{"operation":"set","key":"statusDisparo","value":"Finalizado"},"id":"aeaff71d-cd9c-4075-a95a-16205dbc0490","name":"Redis (set) Finalizado","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-1328,-224],"credentials":{"redis":{"id":"QGqIVKbiyQHm3x0E","name":"Redis account 2"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"962936d1-7ef9-4734-928c-9f8c80e03720","leftValue":"","rightValue":"","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-1792,-288],"id":"9320d95f-abc2-4752-818d-529302f383d6","name":"If2"},{"parameters":{"operation":"set","key":"statusDisparo","value":"Finalizado"},"id":"6a6fb94c-dc10-4435-a878-25de62e0df77","name":"Redis (set) Finalizado1","type":"n8n-nodes-base.redis","typeVersion":1,"position":[-2912,-400],"credentials":{"redis":{"id":"QGqIVKbiyQHm3x0E","name":"Redis account 2"}}}],"connections":{"Webhook":{"main":[[{"node":"Redis","type":"main","index":0}]]},"Redis":{"main":[[{"node":"If","type":"main","index":0}]]},"If":{"main":[[{"node":"Redis1","type":"main","index":0}]]},"Redis1":{"main":[[{"node":"Seed Loop (Function)1","type":"main","index":0}]]},"HTTP Request":{"main":[[{"node":"If1","type":"main","index":0}]]},"If1":{"main":[[{"node":"HTTP Request1","type":"main","index":0}],[{"node":"Redis2","type":"main","index":0}]]},"HTTP Request1":{"main":[[{"node":"Replace Me","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"HTTP Request","type":"main","index":0}]]},"Replace Me":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Seed Loop (Function)1":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Redis (get) inicial":{"main":[[{"node":"IF status == Enviando?","type":"main","index":0}]]},"IF status == Enviando?":{"main":[[{"node":"Responder (já em andamento)","type":"main","index":0}],[{"node":"Redis (set) Enviando","type":"main","index":0}]]},"Redis (set) Enviando":{"main":[[{"node":"Seed Loop (Function)","type":"main","index":0}]]},"Seed Loop (Function)":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"HTTP RegistroParaDisparar":{"main":[[{"node":"If2","type":"main","index":0}]]},"IF tem item?":{"main":[[{"node":"Redis (set) Finalizado","type":"main","index":0}],[{"node":"HTTP EnviarMensagem","type":"main","index":0}]]},"HTTP EnviarMensagem":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Webhook1":{"main":[[{"node":"Redis (get) inicial","type":"main","index":0}]]},"Loop Over Items1":{"main":[[{"node":"HTTP RegistroParaDisparar","type":"main","index":0}],[{"node":"Redis (set) Finalizado","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Redis (set) Finalizado":{"main":[[{"node":"Responder (Finalizado)","type":"main","index":0}]]},"If2":{"main":[[{"node":"IF tem item?","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Webhook":[{"json":{"headers":{"host":"n8n.rasystem.com.br","content-length":"2","content-type":"application/json; charset=utf-8","request-context":"appId=cid-v1:9ebe8575-3f6a-42a0-bf77-0d339e423428","request-id":"|d02470f31f6c412eb060ee072ae12960.03ea70775421924b.","traceparent":"00-d02470f31f6c412eb060ee072ae12960-03ea70775421924b-01","x-forwarded-for":"177.16.191.131","x-forwarded-host":"n8n.rasystem.com.br","x-forwarded-port":"443","x-forwarded-proto":"https","x-forwarded-server":"550769188db1","x-real-ip":"177.16.191.131","accept-encoding":"gzip"},"params":{},"query":{},"body":{},"webhookUrl":"https://n8n.rasystem.com.br/webhook-test/cf585cbf-a525-417c-b239-42628465ae18","executionMode":"test"}}]},"versionId":"14738495-a2ca-406c-8916-76110031f73c","triggerCount":1,"shared":[{"createdAt":"2025-10-21T13:01:17.637Z","updatedAt":"2025-10-21T13:01:17.637Z","role":"workflow:owner","workflowId":"wbQzg5nWoUx1U5QB","projectId":"5dTxE8vBWJ6kQMrp"}],"tags":[]}